public static double fn_A(double a,double b,double c,double d){
  if (a <= 0.0) {
    throw new IllegalArgumentException("random walk window size cannot be negative: " + a);
  }
  double e=c / d;
  if (e > 2.0)   e=2.0;
  if (e < 0.5)   e=0.5;
  double f=a * e;
  if (f > b)   f=b;
  return f;
}
